[
  {
    "projectId": "ae461168-7d1f-4db3-b30c-2c4e93f6d900",
    "testId": "4b809ecc-b092-430a-aefb-4a583d8dd994",
    "userId": "d4886428-00a1-70a3-a9e4-f192c4d328cc",
    "title": "TC001-get hospital revenue data with filters and pagination",
    "description": "Test the /api/hospitals/revenue endpoint to verify it returns hospital revenue data correctly filtered by region, category, yearMonth, and hospitalName. Validate pagination with the limit parameter and ensure the response structure includes success, count, and data fields.",
    "code": "import requests\n\ndef test_get_hospital_revenue_with_filters_and_pagination():\n    base_url = \"http://localhost:3001\"\n    endpoint = \"/api/hospitals/revenue\"\n    url = base_url + endpoint\n\n    # Define filter parameters for test\n    params = {\n        \"region\": \"North\",\n        \"category\": \"General\",\n        \"yearMonth\": \"202312\",\n        \"hospitalName\": \"Central Hospital\",\n        \"limit\": 5\n    }\n\n    try:\n        response = requests.get(url, params=params, timeout=30)\n        response.raise_for_status()\n    except requests.RequestException as e:\n        assert False, f\"HTTP Request failed: {e}\"\n\n    # Validate response content-type\n    content_type = response.headers.get(\"Content-Type\", \"\")\n    assert \"application/json\" in content_type, f\"Unexpected content type: {content_type}\"\n\n    json_resp = response.json()\n    assert isinstance(json_resp, dict), \"Response JSON is not an object\"\n\n    # Validate required fields and types\n    assert \"success\" in json_resp, \"'success' field missing in response\"\n    assert isinstance(json_resp[\"success\"], bool), \"'success' should be boolean\"\n    assert json_resp[\"success\"] is True, \"API call did not succeed\"\n\n    assert \"count\" in json_resp, \"'count' field missing in response\"\n    assert isinstance(json_resp[\"count\"], int), \"'count' should be integer\"\n    assert json_resp[\"count\"] >= 0, \"'count' should be non-negative\"\n\n    assert \"data\" in json_resp, \"'data' field missing in response\"\n    assert isinstance(json_resp[\"data\"], list), \"'data' should be a list\"\n\n    # Validate that count matches length of data or is consistent\n    assert json_resp[\"count\"] == len(json_resp[\"data\"]), \"'count' does not match length of 'data'\"\n\n    # Validate that the number of returned items does not exceed limit\n    assert len(json_resp[\"data\"]) <= params[\"limit\"], \"Returned data exceeds requested limit\"\n\n    # Optional: Validate that data items contain keys relevant to hospital revenue (not strictly specified)\n    if json_resp[\"data\"]:\n        data_item = json_resp[\"data\"][0]\n        assert isinstance(data_item, dict), \"Data item is not an object\"\n        # Check at least one of the filter keys appears in data item to verify filtering\n        filter_keys = [\"region\", \"category\", \"yearMonth\", \"hospitalName\"]\n        matches_filter = any(\n            key in data_item and data_item[key] == params.get(key)\n            for key in filter_keys\n        )\n        # It's possible data might not contain exact keys, but we expect at least one match\n        assert matches_filter, \"Data item does not match filter criteria\"\n\ntest_get_hospital_revenue_with_filters_and_pagination()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-05T03:19:58.140Z",
    "modified": "2025-12-05T03:20:05.590Z"
  },
  {
    "projectId": "ae461168-7d1f-4db3-b30c-2c4e93f6d900",
    "testId": "977e6c40-5d2f-453f-a42e-2087621feed5",
    "userId": "d4886428-00a1-70a3-a9e4-f192c4d328cc",
    "title": "TC002-get aggregated revenue statistics with filters",
    "description": "Test the /api/hospitals/stats endpoint to ensure it returns aggregated revenue statistics filtered by region, category, and yearMonth. Verify the correctness of the aggregated data and the response structure containing success and stats fields.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_get_aggregated_revenue_stats_with_filters():\n    params = {\n        \"region\": \"North\",\n        \"category\": \"General\",\n        \"yearMonth\": \"202312\"\n    }\n    url = f\"{BASE_URL}/api/hospitals/stats\"\n    try:\n        response = requests.get(url, params=params, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n    \n    assert response.status_code == 200, f\"Unexpected status code: {response.status_code}\"\n    try:\n        body = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n\n    # Validate response structure\n    assert \"success\" in body, \"'success' field missing in response\"\n    assert isinstance(body[\"success\"], bool), \"'success' field is not boolean\"\n    assert body[\"success\"] is True, \"'success' field is not True\"\n\n    assert \"stats\" in body, \"'stats' field missing in response\"\n    assert isinstance(body[\"stats\"], dict), \"'stats' field is not an object\"\n\n    stats = body[\"stats\"]\n    # Basic sanity checks for aggregated keys (sum, average or related)\n    # Because schema does not specify structure, check it's not empty\n    assert len(stats) > 0, \"'stats' object is empty\"\n\n    # Example: Check some likely keys if exist\n    # Since exact keys unknown, just check numeric values if present\n    for key, value in stats.items():\n        # If value is a number or nested dict/float etc, allow, else skip\n        if isinstance(value, (int, float)):\n            assert value >= 0, f\"Aggregated stat {key} has negative value\"\n\ntest_get_aggregated_revenue_stats_with_filters()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-05T03:19:58.145Z",
    "modified": "2025-12-05T03:20:09.491Z"
  },
  {
    "projectId": "ae461168-7d1f-4db3-b30c-2c4e93f6d900",
    "testId": "c748b8f1-f52b-4af6-b680-f7ed7311df0a",
    "userId": "d4886428-00a1-70a3-a9e4-f192c4d328cc",
    "title": "TC003-get monthly aggregated statistics for trend analysis",
    "description": "Test the /api/hospitals/stats/monthly endpoint to confirm it returns monthly aggregated statistics filtered by region and category. Validate the response includes success, count, and data fields and that the data is ordered by month.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_get_monthly_aggregated_statistics_for_trend_analysis():\n    url = f\"{BASE_URL}/api/hospitals/stats/monthly\"\n    params = {\n        \"region\": \"North\",\n        \"category\": \"General\"\n    }\n    try:\n        response = requests.get(url, params=params, timeout=TIMEOUT)\n        response.raise_for_status()\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    data = response.json()\n\n    # Validate required fields present\n    assert \"success\" in data, \"'success' field missing in response\"\n    assert \"count\" in data, \"'count' field missing in response\"\n    assert \"data\" in data, \"'data' field missing in response\"\n\n    # Validate success is True\n    assert isinstance(data[\"success\"], bool), \"'success' should be boolean\"\n    assert data[\"success\"] is True, \"API response success is False\"\n\n    # Validate count is integer and matches length of data array\n    assert isinstance(data[\"count\"], int), \"'count' should be integer\"\n    assert isinstance(data[\"data\"], list), \"'data' should be a list\"\n    assert data[\"count\"] == len(data[\"data\"]), \"'count' does not match length of data list\"\n\n    # Validate that 'data' list is ordered by month ascending\n    # Expect each item to have a 'month' field in string format (e.g. \"2023-06\")\n    months = []\n    for item in data[\"data\"]:\n        assert isinstance(item, dict), \"each data item should be a dictionary\"\n        month = item.get(\"month\")\n        assert month is not None, \"each data item must have a 'month' field\"\n        assert isinstance(month, str), \"'month' field should be a string\"\n        months.append(month)\n\n    # Check months list is sorted ascending\n    assert months == sorted(months), \"data is not ordered by month ascending\"\n\ntest_get_monthly_aggregated_statistics_for_trend_analysis()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-05T03:19:58.151Z",
    "modified": "2025-12-05T03:20:06.653Z"
  },
  {
    "projectId": "ae461168-7d1f-4db3-b30c-2c4e93f6d900",
    "testId": "1ecf4737-e2fb-4631-8109-2291359a9ee8",
    "userId": "d4886428-00a1-70a3-a9e4-f192c4d328cc",
    "title": "TC004-get monthly revenue trend for a specific hospital",
    "description": "Test the /api/hospitals/trend endpoint to verify it returns monthly revenue trends for a hospital identified by the required code parameter. Check the limit parameter for result count and validate the response structure with success, count, and data fields.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_get_monthly_revenue_trend_for_hospital():\n    # We need a valid hospital code to test.\n    # Since no hospital resource creation API is provided, \n    # first we try to get hospital revenue data to extract a valid hospital code.\n    try:\n        # Step 1: Get a valid hospital code from /api/hospitals/revenue (limit=1)\n        resp = requests.get(\n            f\"{BASE_URL}/api/hospitals/revenue\",\n            params={\"limit\": 1},\n            timeout=TIMEOUT\n        )\n        assert resp.status_code == 200, f\"Expected 200 but got {resp.status_code}\"\n        resp_json = resp.json()\n        assert resp_json[\"success\"] is True, \"API did not succeed in /api/hospitals/revenue\"\n        data = resp_json.get(\"data\")\n        assert isinstance(data, list) and len(data) > 0, \"No hospital revenue data found\"\n        hospital_record = data[0]\n        # The hospital code parameter is not defined explicitly, guess it's key \"code\"\n        hospital_code = hospital_record.get(\"code\")\n        # If no \"code\" key found, fallback to another possible identifier e.g. \"hospitalCode\" or \"hospital_id\"\n        if not hospital_code:\n            hospital_code = hospital_record.get(\"hospitalCode\") or hospital_record.get(\"hospital_id\")\n        assert hospital_code, \"No valid hospital code found in revenue data\"\n\n        # Step 2: Test /api/hospitals/trend with the hospital_code and limit parameter\n        limit = 5\n        resp_trend = requests.get(\n            f\"{BASE_URL}/api/hospitals/trend\",\n            params={\"code\": hospital_code, \"limit\": limit},\n            timeout=TIMEOUT\n        )\n        assert resp_trend.status_code == 200, f\"Expected 200 but got {resp_trend.status_code}\"\n        trend_json = resp_trend.json()\n\n        # Validate response structure and types\n        assert isinstance(trend_json, dict), \"Response is not a JSON object\"\n        assert \"success\" in trend_json, \"'success' field missing in response\"\n        assert trend_json[\"success\"] is True, \"API returned success=False\"\n\n        assert \"count\" in trend_json, \"'count' field missing in response\"\n        assert isinstance(trend_json[\"count\"], int), \"'count' is not an integer\"\n\n        assert \"data\" in trend_json, \"'data' field missing in response\"\n        assert isinstance(trend_json[\"data\"], list), \"'data' is not a list\"\n\n        # Validate count matches length of data (or less or equal)\n        assert trend_json[\"count\"] == len(trend_json[\"data\"]), \"Count does not match length of data\"\n\n        # Check that the count respects the limit parameter (count <= limit)\n        assert trend_json[\"count\"] <= limit, \"Count exceeds the requested limit\"\n\n        # Optional: Validate minimal structure of items in data array assuming each item is a dict\n        for item in trend_json[\"data\"]:\n            assert isinstance(item, dict), \"An item in data array is not an object\"\n            # Optionally check for expected keys, but no schema details are given for items\n\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_get_monthly_revenue_trend_for_hospital()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-05T03:19:58.156Z",
    "modified": "2025-12-05T03:20:12.755Z"
  },
  {
    "projectId": "ae461168-7d1f-4db3-b30c-2c4e93f6d900",
    "testId": "dbedaad7-9b7b-491f-868d-b04a2e1c5e8c",
    "userId": "d4886428-00a1-70a3-a9e4-f192c4d328cc",
    "title": "TC005-health check for server and database status",
    "description": "Test the /health endpoint to ensure it accurately reports the health status of the server and database connection. Validate the response includes status, database, and totalRecords fields indicating system health.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_health_check_server_and_database_status():\n    url = f\"{BASE_URL}/health\"\n    headers = {\n        \"Accept\": \"application/json\"\n    }\n    try:\n        response = requests.get(url, headers=headers, timeout=TIMEOUT)\n        response.raise_for_status()\n    except requests.RequestException as e:\n        assert False, f\"Request to /health endpoint failed: {e}\"\n\n    try:\n        json_data = response.json()\n    except ValueError:\n        assert False, \"Response from /health is not valid JSON\"\n\n    # Validate that required fields are present\n    required_fields = [\"status\", \"database\", \"totalRecords\"]\n    for field in required_fields:\n        assert field in json_data, f\"Field '{field}' missing in response JSON\"\n\n    # Validate types\n    assert isinstance(json_data[\"status\"], str), \"Field 'status' should be a string\"\n    assert isinstance(json_data[\"database\"], str), \"Field 'database' should be a string\"\n    assert isinstance(json_data[\"totalRecords\"], int), \"Field 'totalRecords' should be an integer\"\n\n    # Optional: Validate the values of status and database are non-empty\n    assert json_data[\"status\"], \"Field 'status' should be non-empty\"\n    assert json_data[\"database\"], \"Field 'database' should be non-empty\"\n    assert json_data[\"totalRecords\"] >= 0, \"Field 'totalRecords' should be zero or a positive integer\"\n\ntest_health_check_server_and_database_status()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-05T03:19:58.163Z",
    "modified": "2025-12-05T03:20:08.262Z"
  }
]
