{
  "meta": {
    "project": "DocBot Hospital Revenue API",
    "date": "2025-12-04",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "DocBot Hospital Revenue API is a backend service providing hospital revenue data and aggregated statistics. It supports filtering by various parameters for analysis and trends, and ensures reliable server and database health checks.",
  "core_goals": [
    "Provide accurate and efficient access to hospital revenue data.",
    "Support flexible data filtering by region, category, yearMonth, and hospitalName.",
    "Offer aggregated statistics and monthly trends for insightful analysis.",
    "Ensure robust error handling and security against SQL injection.",
    "Maintain high availability with health checks for server and database."
  ],
  "key_features": [
    "Retrieve detailed hospital revenue data with optional filtering and pagination.",
    "Fetch aggregated revenue statistics filtered by region, category, and time periods.",
    "Get monthly aggregated statistics to support trend analyses.",
    "Obtain monthly revenue trends for individual hospitals with result limits.",
    "Health check endpoints to report server and database status."
  ],
  "user_flow_summary": [
    "User queries hospital revenue data with filters and receives paginated results.",
    "User requests aggregated statistics with filters and receives summary data.",
    "User requests monthly aggregated stats for trends and gets ordered data by month.",
    "User requests monthly revenue trends for a specific hospital identified by code.",
    "System continuously supports health checks to monitor server and database status."
  ],
  "validation_criteria": [
    "All API endpoints return correct data and handle invalid parameters gracefully.",
    "Filtering parameters correctly applied in data queries with pagination respected.",
    "Aggregated statistics computations (sum, average) verified against database data.",
    "SQL queries built with parameter binding to prevent injection vulnerabilities.",
    "Health check returns accurate server and database status with total record counts.",
    "Error handling with appropriate HTTP status codes and meaningful logs for failures."
  ],
  "code_summary": {
    "tech_stack": [
      "JavaScript",
      "Node.js",
      "Express",
      "SQLite",
      "better-sqlite3"
    ],
    "features": [
      {
        "name": "Get Hospital Revenue",
        "description": "Retrieves a list of hospital revenue data with optional filtering by region, category, yearMonth, and hospitalName.",
        "files": [
          "server/index.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/hospitals/revenue": {
              "get": {
                "summary": "Get hospital revenue data",
                "parameters": [
                  {
                    "name": "region",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "category",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "yearMonth",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "hospitalName",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "integer",
                      "default": 100
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Successful response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "count": {
                              "type": "integer"
                            },
                            "data": {
                              "type": "array"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Get Aggregated Stats",
        "description": "Retrieves aggregated revenue statistics filtered by region, category, and yearMonth.",
        "files": [
          "server/index.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/hospitals/stats": {
              "get": {
                "summary": "Get aggregated revenue statistics",
                "parameters": [
                  {
                    "name": "region",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "category",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "yearMonth",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Successful response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "stats": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Get Monthly Stats",
        "description": "Retrieves monthly aggregated statistics for trend analysis.",
        "files": [
          "server/index.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/hospitals/stats/monthly": {
              "get": {
                "summary": "Get monthly aggregated stats",
                "parameters": [
                  {
                    "name": "region",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "category",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Successful response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "count": {
                              "type": "integer"
                            },
                            "data": {
                              "type": "array"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Get Hospital Trend",
        "description": "Retrieves monthly revenue trend for a specific hospital.",
        "files": [
          "server/index.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/hospitals/trend": {
              "get": {
                "summary": "Get monthly revenue trend for a hospital",
                "parameters": [
                  {
                    "name": "code",
                    "in": "query",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "integer",
                      "default": 36
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Successful response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "count": {
                              "type": "integer"
                            },
                            "data": {
                              "type": "array"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Health Check",
        "description": "Checks the health of the server and database connection.",
        "files": [
          "server/index.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/health": {
              "get": {
                "summary": "Health check",
                "responses": {
                  "200": {
                    "description": "Server is healthy",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "status": {
                              "type": "string"
                            },
                            "database": {
                              "type": "string"
                            },
                            "totalRecords": {
                              "type": "integer"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
